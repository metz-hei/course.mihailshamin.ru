# Как боретесь с тех. долгом?

## Что считается тех. долгом?

Старые версии библиотек

Проблемы в архитектуре

Костыли и плохой код

Недостаточное покрытие тестами или их отсутствие

Пробелы в документации или ее отсутсвие

## Как бороться с тех. долгом?

1. Прописать принципы [инженерной культуры](https://www.notion.so/3137f02c61a04fb58679796092954bea)
2. [Разделить фронтенд и бэкенд](https://bureau.ru/soviet/20200116/)
3. Собирать в бэклог задачи с пометкой «Рефакторинг», а раз в месяц или квартал проводить refactoring meetup, где разбирать накопившийся бэклог. 

    Каждая карточка должна описывать пользу для бизнеса, содержать приоритет рефакторинга (1-5) и оценку в часах. Чтобы быстро оценить технический долг в часах, оцените первые 10–20 задач, а хвост умножьте на среднюю оценку.

    Зачем это нужно? Если в первом квартале было 700 часов, а стало 800, то все в порядке. А если стало 1400:

    - значит надо увеличивать квоту на рефакторинг — договориться с бизнесом, что мы сейчас будем рефакторить целый месяц или 40% всего времени.
    - разбираться, почему так резко растут долги.
4. Выделить под рефакторинг два свободных дня между спринтами.
5. Изолировать плохой код от основного потока разработки. Прям физически — отдельной виртуалкой и правилом в репозитории «сюда больше не коммитим». Весь новый код должен быть написан вне унаследованных репозиториев.
6. Bus-factor. Выписать список областей релевантных для каждой команды, например, для платформенной команды это: видеосвязь, синхронизация упражнений, инструменты. Каждый разработчик ставит оценку от 1 до 3:
    - 1: «Я вообще не понимаю, что это такое, слышал пару раз».
    - 2: «Могу делать задачи из этой области».
    - 3: «Я суперэксперт в этой области».

    Посчитать медианное значение для каждой области, и провести серию докладов для своих коллег.

7. Review code review. В конце каждого месяца выбирать случайный pull requests и еще раз проводить ревью. Когда ты знаешь, что кто-то за тобой перепроверит, ты более ответственно относишься к ревью.

## Совет: Когда бороться с тех. долгом
«Если пилишь фичу — сначала сделай так, чтобы ее удобно было добавлять, а только затем — добавляй».

Как бы ужасно (для менеджеров) это ни звучало — в управлении техническим долгом работает отлично. Если техдолг заметно замедляет выполнение задачи — нужно сначала с ним расплатиться, а потом уже браться за задачу.

Пример — у меня в проекте все очень плохо с пермишенами: используется адская мешанина из булевых полей и встроенного во фреймворк говна. Когда бизнес придет с требованием, которое нельзя реализовать без нормального RBAC, я (конечно испробовав все способы этого не делать) сначала сделаю нормальный RBAC, а затем уже решу задачу.

Так мы тратим когнтивиную энергию программиста (то есть деньги заказчика) не на то, чтобы ухудшить кодовую базу ещё одним куском кода, а на то, чтобы улучшить. Если вся команда исповедует такой подход — в долгосрочной перспективе техдолга будет гораздо меньше.

[Фёдор Борщёв](https://t.me/pmdaily/820) 